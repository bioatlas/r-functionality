<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Get occurrence data — occurrences • SBDI4R</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Get occurrence data — occurrences" />
<meta property="og:description" content="Retrieve SBDI occurrence data via the &quot;occurrence download&quot; web service. At least one of taxon, wkt, or fq must be supplied for a valid query. Note that there is a limit of 500000 records per request when using method=&quot;indexed&quot;. Use the method=&quot;offline&quot; for larger requests. For small requests, method=&quot;indexed&quot; likely to be faster." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SBDI4R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bioatlas/r-functionality">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get occurrence data</h1>
    <small class="dont-index">Source: <a href='https://github.com/bioatlas/r-functionality/blob/master/R/occurrences.R'><code>R/occurrences.R</code></a></small>
    <div class="hidden name"><code>occurrences.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Retrieve SBDI occurrence data via the "occurrence download" web service. At least one of <code>taxon</code>, <code>wkt</code>, or <code>fq</code> must be supplied for a valid query. Note that there is a limit of 500000 records per request when using <code>method="indexed"</code>. Use the <code>method="offline"</code> for larger requests. For small requests, <code>method="indexed"</code> likely to be faster.</p>
    </div>

    <pre class="usage"><span class='fu'>occurrences</span>(
  <span class='no'>taxon</span>,
  <span class='no'>wkt</span>,
  <span class='no'>fq</span>,
  <span class='no'>fields</span>,
  <span class='no'>extra</span>,
  <span class='no'>qa</span>,
  <span class='kw'>email</span> <span class='kw'>=</span> <span class='fu'><a href='sbdi_config.html'>sbdi_config</a></span>()$<span class='no'>email</span>,
  <span class='no'>method</span>,
  <span class='kw'>download_reason_id</span> <span class='kw'>=</span> <span class='fu'><a href='sbdi_config.html'>sbdi_config</a></span>()$<span class='no'>download_reason_id</span>,
  <span class='no'>reason</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fu'><a href='sbdi_config.html'>sbdi_config</a></span>()$<span class='no'>verbose</span>,
  <span class='kw'>record_count_only</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>use_layer_names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>use_data_table</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>taxon</th>
      <td><p>string: (optional) query of the form field:value (e.g. "genus:Macropus")
 or a free text search (e.g. "macropodidae"). Note that a free-text search is 
 equivalent to specifying the "text" field (i.e. <code>taxon="Alaba"</code> is equivalent 
 to <code>taxon="text:Alaba"</code>. The text field is populated with the taxon name 
 along with a handful of other commonly-used fields, and so just specifying your
 target taxon (e.g. taxon="Alaba vibex") will probably work. However, for reliable 
 results it is recommended to use a specific field where possible (see 
 <code><a href='sbdi_fields.html'>sbdi_fields("occurrence_indexed")</a></code> for valid fields). It is also good 
 practice to quote the taxon name if it contains multiple words, for example
<code>taxon="taxon_name:\"Alaba vibex\""</code></p></td>
    </tr>
    <tr>
      <th>wkt</th>
      <td><p>string: (optional) a WKT (well-known text) string providing a spatial 
polygon within which to search, e.g. "POLYGON((140 -37,151 -37,151 -26,140.131 -26,140 -37))"</p></td>
    </tr>
    <tr>
      <th>fq</th>
      <td><p>string: (optional) character string or vector of strings, specifying 
filters to be applied to the original query. These are of the form 
"INDEXEDFIELD:VALUE" e.g. "kingdom:Fungi". See <code><a href='sbdi_fields.html'>sbdi_fields("occurrence_indexed", as_is=TRUE)</a></code> 
for all the fields that are queryable. 
NOTE that fq matches are case-sensitive, but sometimes the entries in the fields are 
not consistent in terms of case (e.g. kingdom names "Fungi" and "Plantae" but "ANIMALIA"). 
fq matches are ANDed by default (e.g. c("field1:abc","field2:def") will match records that have 
field1 value "abc" and field2 value "def"). To obtain OR behaviour, use the form c("field1:abc 
OR field2:def"). See e.g. <a href='http://wiki.apache.org/solr/CommonQueryParameters'>http://wiki.apache.org/solr/CommonQueryParameters</a> 
for more information about filter queries</p></td>
    </tr>
    <tr>
      <th>fields</th>
      <td><p>string vector: (optional) a vector of field names to return. 
Note that the columns of the returned data frame are not guaranteed to retain
 the ordering of the field names given here. If not specified, a default list 
 of fields will be returned. See <code><a href='sbdi_fields.html'>sbdi_fields("occurrence_stored")</a></code> for 
 valid field names with method <code>indexed</code>, and <code><a href='sbdi_fields.html'>sbdi_fields("occurrence")</a></code> 
 for valid field names with method <code>offline</code>. Field names can be passed as 
 full names (e.g. "Radiation - lowest period (Bio22)") rather than id ("el871"). 
 Use <code>fields="all"</code> to include all available fields, but note that 
 <code>"all"</code> will probably cause an error with <code>method="offline"</code> because
  the request URL will exceed the maximum allowable length</p></td>
    </tr>
    <tr>
      <th>extra</th>
      <td><p>string vector: (optional) a vector of field names to include in 
addition to those specified in <code>fields</code>. This is useful if you would like 
the default list of fields (i.e. when <code>fields</code> parameter is not specified) 
plus some additional extras. See <code><a href='sbdi_fields.html'>sbdi_fields("occurrence_stored",as_is=TRUE)</a></code> 
for valid field names. Field names can be passed as full names (e.g. "Radiation
 - lowest period (Bio22)") rather than id ("el871"). Use <code>extra="all"</code> 
 to include all available fields, but note that <code>"all"</code> will probably 
 cause an error with <code>method="offline"</code> because the request URL will exceed 
 the maximum allowable length</p></td>
    </tr>
    <tr>
      <th>qa</th>
      <td><p>string vector: (optional) list of record issues to include in the 
download. Use <code>qa="all"</code> to include all available issues, or <code>qa="none"</code> 
to include none. Otherwise see <code><a href='sbdi_fields.html'>sbdi_fields("assertions",as_is=TRUE)</a></code> for
valid values</p></td>
    </tr>
    <tr>
      <th>email</th>
      <td><p>(required) string: the email address of the user performing the 
download  [default is set by sbdi_config()]</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>DEPRECATED in ALA4R. string: "indexed" (default) or "offline". 
In "offline" mode, more fields are available and larger datasets can be returned</p></td>
    </tr>
    <tr>
      <th>download_reason_id</th>
      <td><p>numeric or string: (required unless record_count_only is TRUE) 
a reason code for the download, either as a numeric ID (currently 0--11) or a 
string (see <code><a href='sbdi_config.html'>sbdi_reasons</a></code> for a list of valid ID codes and names). 
The download_reason_id can be passed directly to this function, or alternatively
set using <code><a href='sbdi_config.html'>sbdi_config(download_reason_id=...)</a></code></p></td>
    </tr>
    <tr>
      <th>reason</th>
      <td><p>string: (optional) user-supplied description of the reason for the 
download. Providing this information is optional but will help the SBDI to better 
support users by building a better understanding of user communities and their
data requests</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical: show additional progress information? 
[default is set by sbdi_config()]</p></td>
    </tr>
    <tr>
      <th>record_count_only</th>
      <td><p>logical: if TRUE, return just the count of records 
that would be downloaded, but don't download them. Note that the record count
 is always re-retrieved from the SBDI, regardless of the caching settings. If
 a cached copy of this query exists on the local machine, the actual data set 
 size may therefore differ from this record count. <code>record_count_only=TRUE</code> 
 can only be used with <code>method="indexed"</code></p></td>
    </tr>
    <tr>
      <th>use_layer_names</th>
      <td><p>logical: if TRUE, layer names will be used as layer 
column names in the returned data frame (e.g. "watsonianViceCounties"). Otherwise, 
layer id value will be used for layer column names (e.g. "cl10009")</p></td>
    </tr>
    <tr>
      <th>use_data_table</th>
      <td><p>logical: if TRUE, attempt to read the data.csv file using 
the fread function from the data.table package. Requires data.table to be available. 
If this fails with an error or warning, or if use_data_table is FALSE, then 
read.table will be used (which may be slower)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Data frame of occurrence results, with one row per occurrence record. 
The columns of the dataframe will depend on the requested fields</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p>Associated SBDI web service for record counts: <a href='https://api.bioatlas.se/#ws3'>https://api.bioatlas.se/#ws3</a></p></li>
<li><p>Associated SBDI web service for occurence downloads: <a href='https://api.bioatlas.se/#ws4'>https://api.bioatlas.se/#ws4</a></p></li>
<li><p>Field definitions: <a href='https://docs.google.com/spreadsheet/ccc?key=0AjNtzhUIIHeNdHhtcFVSM09qZ3c3N3ItUnBBc09TbHc'>https://docs.google.com/spreadsheet/ccc?key=0AjNtzhUIIHeNdHhtcFVSM09qZ3c3N3ItUnBBc09TbHc</a></p></li>
<li><p>WKT reference: <a href='http://www.geoapi.org/3.0/javadoc/org/opengis/referencing/doc-files/WKT.html'>http://www.geoapi.org/3.0/javadoc/org/opengis/referencing/doc-files/WKT.html</a></p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='sbdi_config.html'>sbdi_reasons</a></code> for download reasons; <code><a href='sbdi_config.html'>sbdi_config</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {

<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>occurrences</span>(<span class='kw'>taxon</span><span class='kw'>=</span><span class='st'>"data_resource_uid:dr5"</span>, <span class='kw'>download_reason_id</span><span class='kw'>=</span><span class='st'>"testing"</span>, <span class='kw'>fields</span><span class='kw'>=</span><span class='st'>"all"</span>)
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>occurrences</span>(<span class='kw'>taxon</span><span class='kw'>=</span><span class='st'>"genus:Accipiter"</span>,<span class='kw'>fields</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"decimalLongitude"</span>,<span class='st'>"decimalLatitude"</span>,
  <span class='st'>"vernacularName"</span>,<span class='st'>"taxonRank"</span>,<span class='st'>"rights"</span>),<span class='kw'>download_reason_id</span><span class='kw'>=</span><span class='fl'>10</span>)
 <span class='co'>## download records in polygon, with no quality assertion information</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>occurrences</span>(<span class='kw'>taxon</span><span class='kw'>=</span><span class='st'>"genus:Accipiter"</span>,<span class='kw'>wkt</span><span class='kw'>=</span><span class='st'>"POLYGON((-3 56,-4 56,-4 57,-3 57,-3 56))"</span>,
<span class='kw'>download_reason_id</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>qa</span><span class='kw'>=</span><span class='st'>"none"</span>,<span class='kw'>verbose</span> <span class='kw'>=</span> <span class='no'>T</span>)

<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'>occurrences</span>(<span class='kw'>taxon</span><span class='kw'>=</span><span class='st'>"taxon_name:\"Accipiter gentilis\""</span>,
<span class='kw'>fields</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"decimalLatitude"</span>,<span class='st'>"decimalLongitude"</span>,<span class='st'>"recordedBy"</span>),
<span class='kw'>download_reason_id</span><span class='kw'>=</span><span class='fl'>10</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>y</span>)
<span class='co'># equivalent direct webservice call [see this by setting sbdi_config(verbose=TRUE)]:</span>
<span class='co'># https://records.bioatlas.se/ws/occurrences/index/download?q=taxon_name%</span>
<span class='co'># 3A%22Sialis%20lutaria%22&amp;fields=latitude%2Clongitude%2Cbasis_of_record&amp;</span>
<span class='co'># reasonTypeId=10&amp;sourceTypeId=2001&amp;esc=%5C&amp;sep=%09&amp;file=data</span>

<span class='no'>x</span><span class='kw'>&lt;-</span><span class='fu'>occurrences</span>(<span class='kw'>taxon</span><span class='kw'>=</span><span class='st'>"genus:\"Sialis\""</span>,
               <span class='kw'>fields</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"decimalLatitude"</span>,<span class='st'>"decimalLongitude"</span>,<span class='st'>"recordedBy"</span>),
               <span class='kw'>qa</span><span class='kw'>=</span><span class='st'>"none"</span>,<span class='kw'>download_reason_id</span><span class='kw'>=</span><span class='fl'>10</span>)
<span class='co'># equivalent direct webservice call [see this by setting sbdi_config(verbose=TRUE)]:</span>
<span class='co'># https://records.bioatlas.se/ws/occurrences/index/download?reasonTypeId=10&amp;q=*:*&amp;</span>
<span class='co'># fq=genus:Vulpes&amp;lat=51.5074&amp;lon=0.1278&amp;radius=10.0&amp;qa=none&amp;fields=latitude,longitude&amp;</span>
<span class='co'># reasonTypeId=10&amp;sourceTypeId=2001 </span>
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Debora Arlt, Alejandro Ruete, Anton Hammarström, Marcus Lindh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


